(function(e){if("function"==typeof bootstrap)bootstrap("struct",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeStruct=e}else"undefined"!=typeof window?window.Struct=e():global.Struct=e()})(function(){var e,t,n,r,i;return function s(e,t,n){function r(o,u){if(!t[o]){if(!e[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=t[o]={exports:{}};e[o][0].call(f.exports,function(t){var n=e[o][1][t];return r(n?n:t)},f,f.exports,s,e,t,n)}return t[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,n){var r=e("./types/number"),i=e("./types/string"),s=e("./types/hash"),o=e("./types/array"),u=e("./types/reference"),a=e("./types/storage"),f=e("./utils"),l=t.exports=function(e,t){t||(t={});var n=function(t){Object.defineProperties(this,{_view:{writable:!0,value:null},_offset:{writable:!0,value:null},_definition:{writable:!1,value:e}});for(var n in t)n in e&&(this[n]=t[n]);var r=this;i.forEach(function(e){for(var n in t)n in e.extension&&(r[n]=t[n])})};Object.defineProperties(n,{_offset:{writable:!0,value:null},_definition:{writable:!1,value:e}}),n.storage=t.storage,n._offset=t.offset,f.methodsFor(n,"_offset","offsetFor","setOffset");var i=[];return n.conditional=function(e,t){return i.push({condition:e,extension:t}),this},n.prototype.unpack=function(t,n){function s(e){for(var i in e){var s=e[i];e[i].prop=i;if(s.storage)continue;r[i]=s.read(t,n),typeof s.$unpacked=="function"&&(r[i]=s.$unpacked.call(r,r[i])),r[i]===undefined&&delete r[i],s.external||(n+=s.lengthFor(r)*s.sizeFor(r))}}if(t instanceof DataView){n||(n=0),this._view=t;var r=this;return s.parent=this,s(e),i.forEach(function(e){if(!e.condition.call(r))return;s(e.extension)}),typeof this.$unpacked=="function"&&this.$unpacked(),this}throw new Error("DataView expected")},n.prototype.pack=function(t,n){function o(e){var i=n;for(var o in e){var u=e[o];if(u.external||u.storage)continue;u instanceof a&&u.write(t,n,s[o],n-i),n+=u.lengthFor(s,!0)*u.sizeFor(s,!0)}n=i;for(var o in e){var u=e[o];if(u.external||u.storage)continue;!(u instanceof r)&&!(u instanceof a)&&u.write(t,n,s[o]),n+=u.lengthFor(s,!0)*u.sizeFor(s,!0)}n=i;for(var o in e){var u=e[o];if(u.external||u.storage)continue;var f=s[o];typeof u.$packing=="function"&&(f=s[o]=u.$packing.call(s,f)),u instanceof r&&u.write(t,n,f),n+=u.lengthFor(s,!0)*u.sizeFor(s,!0)}}typeof this.$packing=="function"&&this.$packing(),t||(t=new DataView(new ArrayBuffer(this.lengthFor(this,!0)*this.sizeFor(this,!0)))),n||(n=0);var s=this;return o.parent=this,o(e),i.forEach(function(e){if(!e.condition.call(s))return;o(e.extension)}),t.buffer},n.read=function s(e,t){var n=new this,r=s.caller.parent,i=this.storage?this.offsetFor(r):t;return n.unpack(e,i),n},n.write=function o(e,t,n,r){var i=o.caller.parent,s=this.storage?t+this.offsetFor(i):t;this.setOffset(this.storage?r+this.offsetFor(i):t,i),n.pack(e,s)},n.prototype.lengthFor=n.lengthFor=function(){return 1},n.prototype.sizeFor=n.sizeFor=function(t,n){function s(e){return Object.keys(e).filter(function(t){return!e[t].external&&!e[t].storage}).map(function(r){return e[r].lengthFor(t,!!n)*e[r].sizeFor(t,!!n)}).reduce(function(e,t){return e+t},0)}var r=this,o=s(e);return i.forEach(function(e){if(!e.condition.call(t))return;o+=s(e.extension)}),o},n};l.Int8=new r("getInt8","setInt8",1),l.Uint8=new r("getUint8","setUint8",1),l.Int16=new r("getInt16","setInt16",2),l.Uint16=new r("getUint16","setUint16",2),l.Int32=new r("getInt32","setInt32",4),l.Uint32=new r("getUint32","setUint32",4),l.Float32=new r("getFloat32","setFloat32",4),l.Float64=new r("getFloat64","setFloat64",8),l.String=function(e){return new i(e)},l.Hash=function(e,t,n){return new s(e,t,n)},l.Array=function(e,t){return new o(e,t)},l.Reference=l.Ref=function(e){return new u(e)},l.Storage=function(e,t){return new a(e,t)}},{"./types/array":2,"./types/hash":3,"./types/number":4,"./types/reference":5,"./types/storage":6,"./types/string":7,"./utils":8}],2:[function(e,t,n){var r=e("../utils"),i=e("./reference"),s=t.exports=function(e,t){this.struct=e,Object.defineProperties(this,{_length:{value:t,writable:!0}})};s.prototype.read=function o(e,t){var n=[],r=o.caller.parent;for(var i=0,s=this.lengthFor(r);i<s;++i){var u;typeof this.struct=="function"?(u=new this.struct,u.unpack(e,t),t+=u.lengthFor(r)*u.sizeFor(r)):(u=this.struct.read(e,t),t+=this.struct.lengthFor(r)*this.struct.sizeFor(r)),n.push(u)}return n},s.prototype.write=function u(e,t,n){var r=u.caller.parent,i;this.setLength(this.lengthFor(r,!0),r);for(var s=0,o=this.lengthFor(r);s<o;++s){if((i=n[s])===undefined)break;typeof this.struct=="function"?(i.pack(e,t),t+=i.lengthFor(r)*i.sizeFor(r)):(this.struct.write(e,t,i),t+=this.struct.lengthFor(r)*this.struct.sizeFor(r))}},s.prototype.sizeFor=function(e){return(this.struct.sizeFor?this.struct.sizeFor(e):this.struct.prototype.sizeFor(e))*(this.struct.lengthFor?this.struct.lengthFor(e):this.struct.prototype.lengthFor(e))},s.prototype.lengthFor=function(e,t){return this._length?this._length instanceof i?t?e[this.prop].length:e[this._length.prop]:typeof this._length=="function"?this._length.call(e):this._length:0},s.prototype.setLength=function(e,t){this._length instanceof i?t[this._length.prop]=e:this._length=e}},{"../utils":8,"./reference":5}],3:[function(e,t,n){var r=e("../utils"),i=e("./reference"),s=t.exports=function(e,t,n){this.struct=e,this.key=t,Object.defineProperties(this,{_length:{value:n,writable:!0}})};s.prototype.read=function o(e,t){var n={},r=o.caller.parent;for(var i=0,s=this.lengthFor(r);i<s;++i){var u=new this.struct;u.unpack(e,t),t+=u.lengthFor(r)*u.sizeFor(r),n[u[this.key]]=u}return n},s.prototype.write=function u(e,t,n){var r=Object.keys(n),i=u.caller.parent,s;this.setLength(this.lengthFor(i,!0),i);for(var o=0,a=this.lengthFor(i);o<a;++o){if(!(s=n[r[o]]))continue;s.pack(e,t),t+=s.lengthFor(i)*s.sizeFor(i)}},s.prototype.sizeFor=function(e){return(this.struct.sizeFor?this.struct.sizeFor(e):this.struct.prototype.sizeFor(e))*(this.struct.lengthFor?this.struct.lengthFor(e):this.struct.prototype.lengthFor(e))},s.prototype.lengthFor=function(e,t){return this._length?this._length instanceof i?t?Object.keys(e[this.prop]).length:e[this._length.prop]:this._length:0},s.prototype.setLength=function(e,t){this._length instanceof i?t[this._length.prop]=e:this._length=e}},{"../utils":8,"./reference":5}],4:[function(e,t,n){var r=e("../utils"),i=t.exports=function(e,t,n){this.methods={read:e,write:t},Object.defineProperties(this,{_offset:{value:null,writable:!0},_length:{value:null,writable:!0}}),r.options.call(this,n)};i.prototype.with=function(e){return e.length||(e.length=this._length),new i(this.methods.read,this.methods.write,e)},i.prototype.from=function(e){return this.with({external:!0,offset:e})},i.prototype.read=function s(e,t){var n=s.caller.parent;return e[this.methods.read](this.external?this.offsetFor(n):t)},i.prototype.write=function o(e,t,n){var r=o.caller.parent;e[this.methods.write](this.external?this.offsetFor(r):t,n)},i.prototype.lengthFor=function(){return 1},i.prototype.sizeFor=function(){return this._length},r.methodsFor(i.prototype,"_offset","offsetFor","setOffset")},{"../utils":8}],5:[function(e,t,n){var r=t.exports=function(e){this.prop=e}},{}],6:[function(e,t,n){var r=e("../utils"),i=e("./reference"),s=e("./array"),o=t.exports=function(e,t){this.path=e,t instanceof i&&(t={offset:t}),t=t||{},Object.defineProperties(this,{_offset:{value:t.offset,writable:!0}})};o.prototype.read=function u(e,t){var n=u.caller.parent,r=this.offsetFor(n)||t;!function i(t,n,o){var u=t.shift(),a=n[u];i.parent=o,t.length?a instanceof s?o[u].forEach(function(e){i(t.concat([]),a.struct._definition,e)}):i(t,a,o[u]):o[u]=a.read(e,r)}(this.path.split("."),n._definition,n)},o.prototype.write=function a(e,t,n,r){var i=a.caller.parent,o=0;this.setOffset(r,i),!function u(n,i,a){var f=n.shift(),l=i[f];u.parent=a;if(!n.length){l.setOffset(o,a);var c=a[f],a=l.prototype?a[f]:a;l.write(e,t,c,r),o+=l.lengthFor(a,!0)*l.sizeFor(a,!0)}else l instanceof s?a[f].forEach(function(e){u(n.concat([]),l.struct._definition,e)}):u(n,l,a[f])}(this.path.split("."),i._definition,i)},o.prototype.lengthFor=function(){return 1},o.prototype.sizeFor=function(e,t){var n=0;return!function r(e,i,o){var u=e.shift(),a=i[u];r.parent=o,e.length?a instanceof s?o[u].forEach(function(t){r(e.concat([]),a.struct._definition,t)}):r(e,a,o[u]):(a.prototype&&(o=o[u]),n+=a.lengthFor(o,t)*a.sizeFor(o,t))}(this.path.split("."),e._definition,e),n},r.methodsFor(o.prototype,"_offset","offsetFor","setOffset")},{"../utils":8,"./array":2,"./reference":5}],7:[function(e,t,n){var r=e("../utils"),i=e("./reference"),s=t.exports=function(e){Object.defineProperties(this,{_offset:{value:null,writable:!0},_length:{value:null,writable:!0},_size:{value:null,writable:!0}}),r.options.call(this,e)};s.prototype.read=function o(e,t){var n=[],r,i=o.caller.parent,s=this.external?this.offsetFor(i):this.storage?t+this.offsetFor(i):t;for(var u=0,a=this.lengthFor(i),f=this.sizeFor()===2?2:1;u<a;++u)n.push(e[this.sizeFor()===2?"getUint16":"getUint8"](s+u*f,this.littleEndian));return String.fromCharCode.apply(null,n)},s.prototype.write=function u(e,t,n){var r=[],i,s=u.caller.parent,o=this.external?this.offsetFor(s):this.storage?t+this.offsetFor(s):t;this.setLength(this.lengthFor(s,!0),s);for(var a=0,f=this.lengthFor(s),l=this.sizeFor()===2?2:1;a<f;++a){var c=n.charCodeAt(a)||0;e[this.sizeFor()===2?"setUint16":"setUint8"](o+a*l,c,this.littleEndian)}},s.prototype.sizeFor=function(){return this._size||1},s.prototype.lengthFor=function(e,t){return this._length instanceof i?t?e[this.prop].length:e[this._length.prop]:this._length||0},s.prototype.setLength=function(e,t){this._length instanceof i?t[this._length.prop]=e:this._length=e},r.methodsFor(s.prototype,"_offset","offsetFor","setOffset")},{"../utils":8,"./reference":5}],8:[function(e,t,n){var r=e("./types/reference");n.methodsFor=function(e,t,n,i){e[n]=function(e){return this[t]?this[t]instanceof r?e[this[t].prop]:typeof this[t]=="function"?this[t].call(e):this[t]:0};if(!i)return;e[i]=function(e,n){this[t]instanceof r?n[this[t].prop]=e:this[t]=e}},n.options=function(e){typeof e=="object"?(this._offset=e.offset,this._length=e.length,this._size=e.size,this.$unpacked=e.$unpacked,this.$packing=e.$packing,this.external=e.external===!0,this.storage=e.storage,this.littleEndian=e.littleEndian===!0):this._length=e}},{"./types/reference":5}]},{},[1])(1)});